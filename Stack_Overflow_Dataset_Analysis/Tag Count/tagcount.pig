-- tagcount.pigREGISTER /Users/hdadmin/Documents/myudfun.jar;loaded = LOAD 'hdfs://localhost:9000/output/part-m-00000' Using PigStorage() AS (rowId:int, ownerUserId:int, creationDate:long, postTypeId:int, title:chararray, viewCount:float, score:float, tags:chararray);
generated = FOREACH loaded GENERATE FLATTEN(myudfun.myclass(tags)) AS myword;
grouped = GROUP generated BY myword;
counted = FOREACH grouped GENERATE COUNT(generated) AS tagcount, group;
ordered = ORDER counted BY tagcount DESC;
STORE ordered INTO '/piggy';